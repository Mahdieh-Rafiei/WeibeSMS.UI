<app-loading-spinner *ngIf="showSpinner"></app-loading-spinner>

<div class="flex-container forgot">
  <div class="flex-container-child">
    <div class="img-logo text-center">
      <img src="../../../assets/images/LogoLogin.svg" class="center-block img-responsive">
    </div>
    <div class="flex-content right-box">
      <form class="form-content" *ngIf="step==1" #formDir="ngForm" (keydown)="keySendVerificationCode($event)">
        <div class="text-center">
          <h3>Reset Password</h3>
          <span class="welcome-text">We'll send you verification code, check your mobile :)</span>
        </div>

<!--        <div [formGroup]="forgotPasswordForm">-->
<!--          <div class="input-box v-input-box">-->
<!--            <input type="text"-->
<!--                   placeholder="Your phone number"-->
<!--                   class="ws-login-input vinput"-->
<!--                   formControlName="Mobile"-->
<!--                   appNumericInput-->
<!--                   autofocus autocomplete="off">-->
<!--            <select class="v-input-select" formControlName="prefixNumberId">-->
<!--              <option hidden value="">select</option>-->
<!--              <option *ngFor="let country of countries" [value]="country.id">-->
<!--                {{country.prefixNumber}}-->
<!--              </option>-->
<!--            </select>-->
<!--          </div>-->
<!--          <div class="error-place">-->
<!--            <div class="text-left"-->
<!--                 *ngIf="((forgotPasswordForm.dirty || forgotPasswordForm.touched || formDir.submitted))">-->
<!--              <p class="errorMessage" *ngIf="forgotPasswordForm.hasError('required', 'Mobile')|| forgotPasswordForm.hasError('required', 'prefixNumberId')">-->
<!--                <i class="far fa-exclamation-circle"></i>  this filed is required!-->
<!--              </p>-->
<!--              <p class="errorMessage"-->
<!--                 *ngIf="(forgotPasswordForm.controls['Mobile'].hasError('pattern') && (forgotPasswordForm.controls['Mobile'].touched))">-->
<!--                <i class="far fa-exclamation-circle"></i> phone number is invalid!-->
<!--              </p>-->
<!--            </div>-->
<!--          </div>-->
<!--        </div>-->
        <div class="mt-3 mb-3">
          <div class="flex-group" [formGroup]="forgotPasswordForm">
            <select class="form-control" formControlName="prefixNumberId">
              <option hidden value="">select</option>
              <option [value]="country.id" *ngFor="let country of countries">
                <span>{{country.prefixNumber}}</span>
                <span>{{country.name}}</span>
              </option>
            </select>
            <input type="text"
                   placeholder="Your phone number"
                   class="form-control"
                   formControlName="Mobile"
                   appNumericInput
                   autofocus autocomplete="off">
          </div>
          <div class="text-left"
               *ngIf="((forgotPasswordForm.dirty || forgotPasswordForm.touched || formDir.submitted))">
            <p class="errorMessage"
               *ngIf="forgotPasswordForm.hasError('required', 'Mobile')">
              <i class="fas fa-exclamation-circle"></i> this filed is required!
            </p>
            <p class="errorMessage"
               *ngIf="(forgotPasswordForm.controls['Mobile'].hasError('pattern')) && (forgotPasswordForm.controls['Mobile'].touched || enterPressConfirm)">
              phone number is invalid!
            </p>
          </div>
        </div>

        <div class="mt-3">
          <button type="submit" class="ws-btn login-btn" (click)="sendVerificationCode()">
            Get Verification mCode
          </button>
        </div>
        <div class="text-center">
          <hr>
          <p class="welcome-text">Go back to <span class="sign-in"
                                                   [routerLink]="['../login']">Sign in</span> page</p>
        </div>
      </form>

      <div *ngIf="step==2">
        <div class="text-center">
          <h3>Reset Password</h3>
          <span class="welcome-text">We'll send you verification code, check your mobile :)</span>
        </div>
        <div class="detail-box">
          <div>
            <p class="wrong welcome-text">your number : <span class="mobile-num">{{forgotPasswordForm['controls'].Mobile.value}}</span>
              <span
                (click)="step=1"> wrong ? </span></p>
            <p class="text-left welcome-text">Enter verification code: </p>
          </div>
          <div class="input-box-vc">
            <input appNumericInput maxlength="1" autofocus [(ngModel)]="verificationCodePart1"
                   (ngModelChange)="setFocus(1,$event)" (keydown)="changeFocus(1,$event)"
                   #verificationCodePart1Element type="text"
                   class="verification-code-input" placeholder="-">
            <input appNumericInput maxlength="1" [(ngModel)]="verificationCodePart2"
                   (ngModelChange)="setFocus(2,$event)" (keydown)="changeFocus(2,$event)"
                   #verificationCodePart2Element type="text"
                   class="verification-code-input" placeholder="-">
            <input appNumericInput maxlength="1" [(ngModel)]="verificationCodePart3"
                   (ngModelChange)="setFocus(3,$event)" (keydown)="changeFocus(3,$event)"
                   #verificationCodePart3Element type="text"
                   class="verification-code-input" placeholder="-">
            <input appNumericInput maxlength="1" [(ngModel)]="verificationCodePart4"
                   (ngModelChange)="setFocus(4,$event)" (keydown)="changeFocus(4,$event)"
                   #verificationCodePart4Element type="text"
                   class="verification-code-input" placeholder="-">
            <input appNumericInput maxlength="1" [(ngModel)]="verificationCodePart5"
                   (ngModelChange)="setFocus(5,$event)" (keydown)="changeFocus(5,$event)"
                   #verificationCodePart5Element type="text"
                   class="verification-code-input" placeholder="-">
          </div>
          <div>
            <app-countdown (countDownEmit)="getCountDown($event)"></app-countdown>
          </div>
        </div>
        <div class="text-center">
          <hr>
          <p class="welcome-text">Go back to <span [routerLink]="['../login']"
                                                   class="sign-in">Sign in</span> page</p>
        </div>
      </div>

      <form class="form-content" *ngIf="step==3" #formPass="ngForm" [formGroup]="resetPassForm"
            (keydown)="keySendVerificationCode($event)">
        <div class="text-center">
          <h3>Reset Password</h3>
          <span class="welcome-text">Update your account password</span>
        </div>
        <div class="col-md-10 offset-md-1 col-xs-12">
          <div class="form-group">
            <input [(ngModel)]="password"
                   type="password"
                   class="ws-login-input vinput reset-password-input"
                   autofocus
                   formControlName="password"
                   autocomplete="off"
                   placeholder="Enter your new password">
            <div class="text-left"
                 *ngIf="(((resetPassForm.controls['password'].touched) || formPass.submitted))">
              <ul class="pl-0 pt-1">
                <li class="errorMessage pl-0" *ngIf="resetPassForm.hasError('required', 'password')">
                  <i class="fa fa-check-circle"></i><span class="pl-1">this filed is required!</span>
                </li>
                <ul *ngIf="resetPassForm.controls['password'].hasError('pattern')">
                  <li class="errorMessage pl-0">
                    <i class="fa fa-check-circle"></i><span class="pl-1"> min length is 8 char!</span>
                  </li>
                  <li class="errorMessage">
                    <i class="fa fa-check-circle"></i><span class="pl-1">least one Digit letter!</span>
                  </li>
                  <li class="errorMessage">
                    <i class="fa fa-check-circle"></i><span class="pl-1">least one uppercase letter!</span>
                  </li>
                  <li class="errorMessage">
                    <i class="fa fa-check-circle"></i><span class="pl-1">least one LowerCase letter!</span>
                  </li>
                  <li class="errorMessage">
                    <i class="fa fa-check-circle"></i><span class="pl-1">least one Symbol letter!</span>
                  </li>
                </ul>
              </ul>
            </div>
          </div>
          <div class="form-group">
            <input [(ngModel)]="confirmPassword"
                   type="password"
                   formControlName="confirmPassword"
                   class="ws-login-input vinput reset-password-input"
                   autofocus
                   (input)="confirmPasswordOut()"
                   (focusout)="confirmPasswordOut()"
                   autocomplete="off"
                   placeholder="Confirm your password">
            <div class="text-left">
              <p class="errorMessage" *ngIf="notMatch">
                Confirm value is not correct!
              </p>
            </div>
          </div>
        </div>
        <div class="col-md-10 offset-md-1 col-sm-12 col-xs-12">
          <button type="submit" class="ws-btn login-btn" (click)="changePassword()">Reset Password</button>
        </div>
      </form>
    </div>

    <div class="footer-weib text-center">
      <p class="copyright">©2019 Weiß SMS. All rights reserved.</p>
    </div>
  </div>
</div>


