<app-loading-spinner *ngIf="showSpinner"></app-loading-spinner>
<div class="flex-container forgot">
    <div class="flex-container-child">
        <div class="img-logo text-center">
            <img src="../../../assets/images/LogoLogin.svg" class="center-block img-responsive">
        </div>
        <div class="flex-content pt-3">
            <form class="form-content pr-4 pl-4 pb-3" *ngIf="step==1" #formDir="ngForm"
                  (keydown)="keySendVerificationCode($event)">
                <div class="text-center">
                    <h5>Reset Password</h5>
                    <span class="gray-text p-b2 fo-2">We'll send you verification code, check your mobile :)</span>
                </div>
                <div class="mt-3 mb-3">
                    <div class="flex-group" [formGroup]="forgotPasswordForm" *ngIf="countries">
                        <div class="btn-group">
                            <button class="form-control dropdown-toggle btn-default btn-select" type="button"
                                    data-toggle="dropdown" role="button" aria-expanded="true">
                                <img class="mr-2" width="20" [src]="'data:image/jpg;base64,'+countryFlag"/>
                            </button>
                            <div class="custom-dropdown">
                                <ul class="dropdown-menu" role="listbox" aria-expanded="true">
                                    <li class="dropdown-item" *ngFor="let country of countries"
                                        (click)="selectCountry(2, country)">
                                        <img class="ml-2 mr-2" width="20"
                                             [src]="'data:image/jpg;base64,'+country.flag"/>
                                        <span>{{country.name}}</span>
                                        (<span>{{country.prefixNumber}}</span>)
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <input type="text"
                               #mobileInput
                               placeholder="Your phone number"
                               class="form-control"
                               formControlName="Mobile"
                               (input)="changeMobile(mobileInput.value)"
                               appNumericInput
                               [ngClass]="{'border-error' : (forgotPasswordForm.controls['Mobile'].hasError('pattern')) && (forgotPasswordForm.controls['Mobile'].touched || enterPressConfirm)}"
                               autofocus autocomplete="off">
                    </div>
                    <div class="text-left"
                         *ngIf="((forgotPasswordForm.dirty || forgotPasswordForm.touched || formDir.submitted))">
                        <p class="errorMessage"
                           *ngIf="forgotPasswordForm.hasError('required', 'Mobile')">
                            <i class="fas fa-exclamation-circle"></i> this filed is required!
                        </p>
                        <p class="errorMessage"
                           *ngIf="(forgotPasswordForm.controls['Mobile'].hasError('pattern')) && (forgotPasswordForm.controls['Mobile'].touched || enterPressConfirm)">
                            phone number is invalid!
                        </p>
                    </div>
                </div>

                <div class="mt-3">
                    <button type="submit" class="ws-btn login-btn" (click)="sendVerificationCode()">
                        Get Verification mCode
                    </button>
                </div>
                <div class="text-center">
                    <hr>
                    <p class="welcome-text">Go back to <span class="sign-fill"
                                                             [routerLink]="['../login']">Sign in</span> page</p>
                </div>
            </form>

            <div class="form-content pr-4 pl-4 pb-3" *ngIf="step==2">
                <div class="text-center">
                    <h5>Reset Password</h5>
                    <span class="gray-text fo-2">We'll send you verification code, check your mobile :)</span>
                </div>
                <div>
                    <div class="input-box pt-2">
                        <p class="wrong welcome-text">your number : <span class="mobile-num">{{forgotPasswordForm['controls'].Mobile.value}}</span>
                            <span
                                    (click)="step=1"> wrong ? </span></p>
                        <p class="text-left welcome-text">Enter verification code: </p>
                    </div>
                    <div>
                        <input appNumericInput maxlength="1" autofocus [(ngModel)]="verificationCodePart1"
                               (ngModelChange)="setFocus(1,$event)" (keydown)="changeFocus(1,$event)"
                               #verificationCodePart1Element type="text"
                               class="verification-code-input" placeholder="-">
                        <input appNumericInput maxlength="1" [(ngModel)]="verificationCodePart2"
                               (ngModelChange)="setFocus(2,$event)" (keydown)="changeFocus(2,$event)"
                               #verificationCodePart2Element type="text"
                               class="verification-code-input" placeholder="-">
                        <input appNumericInput maxlength="1" [(ngModel)]="verificationCodePart3"
                               (ngModelChange)="setFocus(3,$event)" (keydown)="changeFocus(3,$event)"
                               #verificationCodePart3Element type="text"
                               class="verification-code-input" placeholder="-">
                        <input appNumericInput maxlength="1" [(ngModel)]="verificationCodePart4"
                               (ngModelChange)="setFocus(4,$event)" (keydown)="changeFocus(4,$event)"
                               #verificationCodePart4Element type="text"
                               class="verification-code-input" placeholder="-">
                        <input appNumericInput maxlength="1" [(ngModel)]="verificationCodePart5"
                               (ngModelChange)="setFocus(5,$event)" (keydown)="changeFocus(5,$event)"
                               #verificationCodePart5Element type="text"
                               class="verification-code-input" placeholder="-">
                    </div>
                    <div>
                        <app-countdown (countDownEmit)="getCountDown($event)"></app-countdown>
                    </div>
                </div>
                <div class="text-center">
                    <hr>
                    <p class="gray-text fo-2">Go back to <span [routerLink]="['../login']"
                                                             class="sign-fill">Sign in</span> page</p>
                </div>
            </div>

            <form class="form-content pr-4 pl-4 pb-3" *ngIf="step==3" #formPass="ngForm" [formGroup]="resetPassForm"
                  (keydown)="keySendVerificationCode($event)">
                <div class="text-center mb-2">
                    <h5>Reset Password</h5>
                    <span class="gray-text fo-2">Update your account password</span>
                </div>
                <div class="col-md-12">
                    <div class="form-group">
                        <input [(ngModel)]="password"
                               type="password"
                               class="form-control"
                               autofocus
                               formControlName="password"
                               autocomplete="off"
                               placeholder="Enter your new password">
                        <div class="text-left"
                             *ngIf="(((resetPassForm.controls['password'].touched) || formPass.submitted))">
                            <ul class="pl-0 pt-1">
                                <li class="errorMessage pl-0" *ngIf="resetPassForm.hasError('required', 'password')">
                                    <i class="fa fa-check-circle"></i><span class="pl-1">this filed is required!</span>
                                </li>
                                <ul *ngIf="resetPassForm.controls['password'].hasError('pattern')">
                                    <li class="errorMessage pl-0">
                                        <i class="fa fa-check-circle"></i><span
                                            class="pl-1"> min length is 8 char!</span>
                                    </li>
                                    <li class="errorMessage">
                                        <i class="fa fa-check-circle"></i><span
                                            class="pl-1">least one Digit letter!</span>
                                    </li>
                                    <li class="errorMessage">
                                        <i class="fa fa-check-circle"></i><span
                                            class="pl-1">least one uppercase letter!</span>
                                    </li>
                                    <li class="errorMessage">
                                        <i class="fa fa-check-circle"></i><span
                                            class="pl-1">least one LowerCase letter!</span>
                                    </li>
                                    <li class="errorMessage">
                                        <i class="fa fa-check-circle"></i><span
                                            class="pl-1">least one Symbol letter!</span>
                                    </li>
                                </ul>
                            </ul>
                        </div>
                    </div>
                    <div class="form-group">
                        <input [(ngModel)]="confirmPassword"
                               type="password"
                               formControlName="confirmPassword"
                               class="form-control"
                               autofocus
                               (input)="confirmPasswordOut()"
                               (focusout)="confirmPasswordOut()"
                               autocomplete="off"
                               placeholder="Confirm your password">
                        <div class="text-left">
                            <p class="errorMessage" *ngIf="notMatch">
                                Confirm value is not correct!
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 col-sm-12 col-xs-12">
                    <button type="submit" class="ws-btn login-btn" (click)="changePassword()">Reset Password</button>
                </div>
            </form>
        </div>

        <div class="footer-weib text-center">
            <p class="copyright">©2019 Weiß SMS. All rights reserved.</p>
        </div>
    </div>
</div>


